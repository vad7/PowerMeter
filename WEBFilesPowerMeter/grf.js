(function(b){var d={extend:function(){arguments[0]=arguments[0]||{};for(var f=1;f<arguments.length;f++){for(var e in arguments[f]){if(arguments[f].hasOwnProperty(e)){if(typeof(arguments[f][e])==="object"){if(arguments[f][e] instanceof Array){arguments[0][e]=arguments[f][e]}else{arguments[0][e]=d.extend(arguments[0][e],arguments[f][e])}}else{arguments[0][e]=arguments[f][e]}}}}return arguments[0]}};function a(e){this.options=d.extend({},a.defaultOptions,e);this.clear()}a.defaultOptions={resetBoundsInterval:3000,resetBounds:true};a.prototype.clear=function(){this.data=[];this.maxValue=Number.NaN;this.minValue=Number.NaN};a.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1];this.minValue=this.data[0][1];for(var e=1;e<this.data.length;e++){var f=this.data[e][1];if(f>this.maxValue){this.maxValue=f}if(f<this.minValue){this.minValue=f}}}else{this.maxValue=Number.NaN;this.minValue=Number.NaN}};a.prototype.append=function(h,g,f){var e=this.data.length-1;while(e>=0&&this.data[e][0]>h){e--}if(e===-1){this.data.splice(0,0,[h,g])}else{if(this.data.length>0&&this.data[e][0]===h){if(f){this.data[e][1]+=g;g=this.data[e][1]}else{this.data[e][1]=g}}else{if(e<this.data.length-1){this.data.splice(e+1,0,[h,g])}else{this.data.push([h,g])}}}this.maxValue=isNaN(this.maxValue)?g:Math.max(this.maxValue,g);this.minValue=isNaN(this.minValue)?g:Math.min(this.minValue,g)};a.prototype.dropOldData=function(e,f){var g=0;while(this.data.length-g>=f&&this.data[g+1][0]<e){g++}if(g!==0){this.data.splice(0,g)}};function c(e){this.options=d.extend({},c.defaultChartOptions,e);this.seriesSet=[];this.currentValueRange=1;this.currentVisMinValue=0;this.lastRenderTimeMillis=0}c.defaultChartOptions={millisPerPixel:20,enableDpiScaling:true,yMinFormatter:function(f,e){return parseFloat(f).toFixed(e)},yMaxFormatter:function(e,f){return parseFloat(e).toFixed(f)},maxValueScale:1,interpolation:"bezier",scaleSmoothing:0.125,maxDataSetLength:2,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,sharpLines:false,millisPerLine:1000,verticalSections:2,borderVisible:true},labels:{fillStyle:"#ffffff",disabled:false,fontSize:10,fontFamily:"monospace",precision:2},horizontalLines:[]};c.AnimateCompatibility=(function(){var f=function(i,g){var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(j){return window.setTimeout(function(){j(new Date().getTime())},16)};return h.call(window,i,g)},e=function(h){var g=window.cancelAnimationFrame||function(i){clearTimeout(i)};return g.call(window,h)};return{requestAnimationFrame:f,cancelAnimationFrame:e}})();c.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"};c.prototype.addTimeSeries=function(f,e){this.seriesSet.push({timeSeries:f,options:d.extend({},c.defaultSeriesPresentationOptions,e)});if(f.options.resetBounds&&f.options.resetBoundsInterval>0){f.resetBoundsTimerId=setInterval(function(){f.resetBounds()},f.options.resetBoundsInterval)}};c.prototype.removeTimeSeries=function(g){var f=this.seriesSet.length;for(var e=0;e<f;e++){if(this.seriesSet[e].timeSeries===g){this.seriesSet.splice(e,1);break}}if(g.resetBoundsTimerId){clearInterval(g.resetBoundsTimerId)}};c.prototype.getTimeSeriesOptions=function(g){var f=this.seriesSet.length;for(var e=0;e<f;e++){if(this.seriesSet[e].timeSeries===g){return this.seriesSet[e].options}}};c.prototype.bringToFront=function(g){var f=this.seriesSet.length;for(var e=0;e<f;e++){if(this.seriesSet[e].timeSeries===g){var h=this.seriesSet.splice(e,1);this.seriesSet.push(h[0]);break}}};c.prototype.streamTo=function(e,f){this.canvas=e;this.delay=f;this.start()};c.prototype.start=function(){if(this.frame){return}if(this.options.enableDpiScaling&&window&&window.devicePixelRatio!==1){var e=this.canvas.getAttribute("width");var g=this.canvas.getAttribute("height");this.canvas.setAttribute("width",e*window.devicePixelRatio);this.canvas.setAttribute("height",g*window.devicePixelRatio);this.canvas.style.width=e+"px";this.canvas.style.height=g+"px";this.canvas.getContext("2d").scale(window.devicePixelRatio,window.devicePixelRatio)}var f=function(){this.frame=c.AnimateCompatibility.requestAnimationFrame(function(){this.render();f()}.bind(this))}.bind(this);f()};c.prototype.stop=function(){if(this.frame){c.AnimateCompatibility.cancelAnimationFrame(this.frame);delete this.frame}};c.prototype.updateValueRange=function(){var g=this.options,j=Number.NaN,k=Number.NaN;for(var i=0;i<this.seriesSet.length;i++){var m=this.seriesSet[i].timeSeries;if(!isNaN(m.maxValue)){j=!isNaN(j)?Math.max(j,m.maxValue):m.maxValue}if(!isNaN(m.minValue)){k=!isNaN(k)?Math.min(k,m.minValue):m.minValue}}if(g.maxValue!=null){j=g.maxValue}else{j*=g.maxValueScale}if(g.minValue!=null){k=g.minValue}if(this.options.yRangeFunction){var h=this.options.yRangeFunction({min:k,max:j});k=h.min;j=h.max}if(!isNaN(j)&&!isNaN(k)){var e=j-k;var f=(e-this.currentValueRange);var l=(k-this.currentVisMinValue);this.isAnimatingScale=Math.abs(f)>0.1||Math.abs(l)>0.1;this.currentValueRange+=g.scaleSmoothing*f;this.currentVisMinValue+=g.scaleSmoothing*l}this.valueRange={min:k,max:j}};c.prototype.render=function(j,n){var p=new Date().getTime();if(!this.isAnimatingScale){var E=Math.min(1000/6,this.options.millisPerPixel);if(p-this.lastRenderTimeMillis<E){return}}this.lastRenderTimeMillis=p;j=j||this.canvas;n=n||p-(this.delay||0);n-=n%this.options.millisPerPixel;var g=j.getContext("2d"),K=this.options,l={top:0,left:0,width:j.clientWidth,height:j.clientHeight},H=n-(l.width*K.millisPerPixel),r=function(i){var t=i-this.currentVisMinValue;return this.currentValueRange===0?l.height:l.height-(Math.round((t/this.currentValueRange)*l.height))}.bind(this),F=function(i){return Math.round(l.width-((n-i)/K.millisPerPixel))};this.updateValueRange();g.font=K.labels.fontSize+"px "+K.labels.fontFamily;g.save();g.translate(l.left,l.top);g.beginPath();g.rect(0,0,l.width,l.height);g.clip();g.save();g.fillStyle=K.grid.fillStyle;g.clearRect(0,0,l.width,l.height);g.fillRect(0,0,l.width,l.height);g.restore();g.save();g.lineWidth=K.grid.lineWidth;g.strokeStyle=K.grid.strokeStyle;if(K.grid.millisPerLine>0){g.beginPath();for(var C=n-(n%K.grid.millisPerLine);C>=H;C-=K.grid.millisPerLine){var B=F(C);if(K.grid.sharpLines){B-=0.5}g.moveTo(B,0);g.lineTo(B,l.height)}g.stroke();g.closePath()}for(var A=1;A<K.grid.verticalSections;A++){var z=Math.round(A*l.height/K.grid.verticalSections);if(K.grid.sharpLines){z-=0.5}g.beginPath();g.moveTo(0,z);g.lineTo(l.width,z);g.stroke();g.closePath()}if(K.grid.borderVisible){g.beginPath();g.strokeRect(0,0,l.width,l.height);g.closePath()}g.restore();if(K.horizontalLines&&K.horizontalLines.length){for(var f=0;f<K.horizontalLines.length;f++){var w=K.horizontalLines[f],G=Math.round(r(w.value))-0.5;g.strokeStyle=w.color||"#ffffff";g.lineWidth=w.lineWidth||1;g.beginPath();g.moveTo(0,G);g.lineTo(l.width,G);g.stroke();g.closePath()}}for(var M=0;M<this.seriesSet.length;M++){g.save();var J=this.seriesSet[M].timeSeries,I=J.data,o=this.seriesSet[M].options;J.dropOldData(H,K.maxDataSetLength);g.lineWidth=o.lineWidth;g.strokeStyle=o.strokeStyle;g.beginPath();var u=0,m=0,k=0;for(var L=0;L<I.length&&I.length!==1;L++){var s=F(I[L][0]),q=r(I[L][1]);if(L===0){u=s;g.moveTo(s,q)}else{switch(K.interpolation){case"linear":case"line":g.lineTo(s,q);break;case"bezier":default:g.bezierCurveTo(Math.round((m+s)/2),k,Math.round((m+s))/2,q,s,q);break;case"step":g.lineTo(s,k);g.lineTo(s,q);break}}m=s;k=q}if(I.length>1){if(o.fillStyle){g.lineTo(l.width+o.lineWidth+1,k);g.lineTo(l.width+o.lineWidth+1,l.height+o.lineWidth+1);g.lineTo(u,l.height+o.lineWidth);g.fillStyle=o.fillStyle;g.fill()}if(o.strokeStyle&&o.strokeStyle!=="none"){g.stroke()}g.closePath()}g.restore()}if(!K.labels.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var h=K.yMaxFormatter(this.valueRange.max,K.labels.precision),P=K.yMinFormatter(this.valueRange.min,K.labels.precision);g.fillStyle=K.labels.fillStyle;g.fillText(h,l.width-g.measureText(h).width-2,K.labels.fontSize);g.fillText(P,l.width-g.measureText(P).width-2,l.height-2)}if(K.timestampFormatter&&K.grid.millisPerLine>0){var O=l.width-g.measureText(P).width+4;for(var C=n-(n%K.grid.millisPerLine);C>=H;C-=K.grid.millisPerLine){var B=F(C);if(B<O){var N=new Date(C),e=K.timestampFormatter(N),D=g.measureText(e).width;O=B-D-2;g.fillStyle=K.labels.fillStyle;g.fillText(e,B-D,l.height-2)}}}g.restore()};c.timeFormatter=function(e){function f(g){return(g<10?"0":"")+g}return f(e.getHours())+":"+f(e.getMinutes())+":"+f(e.getSeconds())};b.TimeSeries=a;b.SmoothieChart=c})(typeof exports==="undefined"?this:exports);var line1=new TimeSeries();var newval=0;function addpoint(xmlData){if(xmlData){newval=eval(getXMLValue(xmlData,"value"));line1.append(new Date().getTime(),newval);document.getElementById("xdata").innerHTML=newval;if(newval>xmax){document.getElementById("xdata").style.color="#0000A0"}else{if(newval<xmin){document.getElementById("xdata").style.color="#A00000"}else{document.getElementById("xdata").style.color="#00A000"}}}else{line1.append(new Date().getTime(),newval)}}var smoothie=new SmoothieChart({interpolation:"linear",minValue:0,millisPerPixel:millisPerPixel,grid:{strokeStyle:"rgb(100, 110, 150)",fillStyle:"rgb(50, 55, 75)",lineWidth:1,millisPerLine:millisPerLine,verticalSections:6},labels:{precision:0}});smoothie.addTimeSeries(line1,{strokeStyle:"rgb(255, 0, 200)",fillStyle:"rgba(255, 0, 200, 0.3)",lineWidth:3});smoothie.streamTo(document.getElementById("mycanvas"),nextimeout);setTimeout("newAJAXCommand(xmlfile, addpoint, true)",100);function slider(a,b,o,n,i){var e=17;var v=21;var r=21;var k,x;var w=document;var s=w.all||window.opera;var u=(b-e-3)/(n-o);var t=w.createElement("DIV");t.id=a+"_slider";t.className="slider";w.getElementById(a).appendChild(t);var l=w.createElement("DIV");l.id=a+"_knob";l.className="knob";t.appendChild(l);l.style.left=0;l.style.width=e+"px";l.style.height=v+"px";t.style.width=b+"px";t.style.height=r+"px";var j=t.offsetLeft;x=t.offsetParent;while(x.tagName!="BODY"){j+=x.offsetLeft;x=x.offsetParent}if(s){l.onmousedown=q;t.onclick=c;l.onmouseup=m;t.onmouseup=m}else{l.addEventListener("mousedown",q,true);t.addEventListener("click",c,true);l.addEventListener("mouseup",m,true);t.addEventListener("mouseup",m,true)}function f(d){if(d<0){l.style.left=0}else{if(d>b-e-3){l.style.left=(b-3-e)+"px"}else{if(i==0){l.style.left=d+"px"}else{l.style.left=Math.round(d/(i*u))*i*u+"px"}}}nextimeout=g();w.getElementById("toutid").value=nextimeout;document.getElementById("toutid").innerHTML=nextimeout}function h(d){if(d<o||d>n){alert("Value is not included into a slider range!")}else{f((d-o)*u)}nextimeout=g();w.getElementById("toutid").value=nextimeout;document.getElementById("toutid").innerHTML=nextimeout}function g(){return Math.round(parseInt(l.style.left)/u)+o}function c(y){var d;if(s){if(event.srcElement!=t){return}d=event.offsetX-Math.round(e/2)}else{d=y.pageX-j-e/2}f(d)}function q(d){if(s){k=event.clientX-parseInt(l.style.left);t.onmousemove=p}else{t.addEventListener("mousemove",p,true)}}function p(y){var d;if(s){d=event.clientX-k}else{d=y.pageX-j-e/2}f(d)}function m(){if(s){t.onmousemove=null}else{t.removeEventListener("mousemove",p,true)}}this.setValue=h;this.getValue=g}var mysl1=new slider("sl",333,20,10020,0);mysl1.setValue(500);document.getElementById("toutid").innerHTML=mysl1.getValue();